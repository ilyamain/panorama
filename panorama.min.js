// Panorama. Version 0.8
function panorama(w){var g={};var m=false;var v={w:4000,h:2000,x:0,y:0,z:1,dx_dy:0,zmin:1,zmax:5,zstep:0.1,pultarrows:true,pultzoom:true,nozoom:false,pultstep:100,sphearic:false,cylinder:true,add_html:'',title_text:'Panorama',title_class:'pano-title',shell_class:'pano-images',bgclass:'pano-img',bgsrc:'/example.jpg',attr_name:'panorama',link_text:'',link_class:'pano-goto',links:new Array()};var q={a:$('<div>'),b:$('<div>'),bg:$('<div>'),c:new Object(),d:new Array(),z:{w: v.w,h: v.h},p:{x:v.x,y:v.y,z:v.z,px:v.x,py:v.y,dx:v.dx_dy,dy:v.dx_dy}};var ro={set:function(u){for(var k in u){v[k]=u[k];};},render:function(pp){g=pp;h(v.attr_name);fd();fc();fs();fp();}};$(w).on('mousemove touchmove mousedown touchstart mouseup mouseout touchend',q,function(e){var c=new Object;c.x=(e.type==='touchmove')?e.targetTouches[0].pageX:e.clientX;c.y=(e.type==='touchmove')?e.targetTouches[0].pageY:e.clientY;um(c);if((e.type==='mousedown')||(e.type==='touchstart'))m=true;if((e.type==='mouseup')||(e.type==='mouseout')||(e.type==='touchend'))m=false;return false;});$(w).on('mousewheel',q,function(e){var dg=1;var c=new Object;if(e.originalEvent.deltaY>0)dg=-1;c.x=(e.type==='touchmove')?e.targetTouches[0].pageX:e.clientX;c.y=(e.type==='touchmove')?e.targetTouches[0].pageY:e.clientY;fl(dg,c);return false;});return ro;function fd(){if(j(g.pano))g.pano={a:{}};if(j(g.def))g.def=Object.keys(g.pano)[0];for(var k in g.pano){if(j(g.pano[k].pultstep))g.pano[k].pultstep=v.pultstep;if(j(g.pano[k].add_html))g.pano[k].add_html=v.add_html;if(j(g.pano[k].shell_class))g.pano[k].shell_class=v.shell_class;if(j(g.pano[k].title_class))g.pano[k].title_class=v.title_class;if(j(g.pano[k].title_text))g.pano[k].title_text=v.title_text;if(j(g.pano[k].bgclass))g.pano[k].bgclass=v.bgclass;if(j(g.pano[k].bgsrc))g.pano[k].bgsrc=v.bgsrc;if(j(g.pano[k].bgw))g.pano[k].bgw=v.w;if(j(g.pano[k].bgh))g.pano[k].bgh=v.h;if(j(g.pano[k].bgx))g.pano[k].bgx=v.x;if(j(g.pano[k].bgy))g.pano[k].bgy=v.y;if(j(g.pano[k].bgz))g.pano[k].bgz=v.z;if(j(g.pano[k].bgzmin))g.pano[k].bgzmin=v.zmin;if(j(g.pano[k].bgzmax))g.pano[k].bgzmax=v.zmax;if(j(g.pano[k].bgzstep))g.pano[k].bgzstep=v.zstep;if(j(g.pano[k].links))g.pano[k].links=v.links;if((j(g.pano[k].sphearic))&&(g.pano[k].sphearic!=false))g.pano[k].sphearic=v.sphearic;if((j(g.pano[k].cylinder))&&(g.pano[k].cylinder!=false))g.pano[k].cylinder=v.cylinder;if((j(g.pano[k].pultarrows))&&(g.pano[k].pultarrows!=false))g.pano[k].pultarrows=v.pultarrows;if((j(g.pano[k].pultzoom))&&(g.pano[k].pultzoom!=false))g.pano[k].pultzoom=v.pultzoom;if((j(g.pano[k].nozoom))&&(g.pano[k].nozoom!=false))g.pano[k].nozoom=v.nozoom;};}function h(ta){var hh=$(w).attr(ta);if(!j(hh)){var oj=JSON.parse(hh.replace(/'/g,'"'));for(var k in oj){v[k]=oj[k];};};}function fc(){q.c.a1=g.pano[g.def].pultarrows;q.c.a2=g.pano[g.def].pultzoom;q.c.a3=g.pano[g.def].nozoom;q.c.a4=g.pano[g.def].pultstep;q.c.a5=g.pano[g.def].sphearic;q.c.a6=g.pano[g.def].cylinder;q.c.b=g.pano[g.def].add_html;q.c.c1=g.pano[g.def].shell_class;q.c.c2=g.pano[g.def].title_class;q.c.c3=g.pano[g.def].title_text;q.c.c4=g.pano[g.def].bgclass;q.c.g=g.pano[g.def].bgsrc;q.c.w=g.pano[g.def].bgw;q.c.h=g.pano[g.def].bgh;q.c.x=g.pano[g.def].bgx;q.c.y=g.pano[g.def].bgy;q.c.z=g.pano[g.def].bgz;q.c.z1=g.pano[g.def].bgzmin;q.c.z2=g.pano[g.def].bgzmax;q.c.s=g.pano[g.def].bgzstep;q.c.l=g.pano[g.def].links;q.p.x=q.c.x;q.p.y=q.c.y;q.p.z=q.c.z;ff('xyz');q.d=[];q.c.l.map(function(i){if(j(i.content))i.content=v.link_text;if(j(i.class_name))i.class_name=v.link_class;if(j(i.x))i.x=0;if(j(i.y))i.y=0;if(j(i.center_x))i.center_x=0;if(j(i.center_y))i.center_y=0;if(j(i.drag))i.drag=false;if(j(i.set))i.set=g.def;var l={cx:i.x,cy:i.y,ax:i.center_x,ay:i.center_y,d:i.drag,s:i.set,q:$('<div>'),n:i.class_name,t:i.content};q.d.push(l);});}function ff(c){if(c.indexOf('z')>-1){if(q.p.z<q.c.z1)q.p.z=q.c.z1;if(q.p.z>q.c.z2)q.p.z=q.c.z2;}q.z.w=q.c.w*q.p.z;q.z.h=q.c.h*q.p.z;if(c.indexOf('x')>-1)q.p.x=a(q.p.x);if(c.indexOf('y')>-1){q.p.y=q.p.y%q.z.h;if(!q.c.a5){var b=$(w).height()-q.z.h;if(q.p.y>=0)q.p.y=0;if(q.p.y<=b)q.p.y=b;}}}function fs(){q.b.addClass(q.c.c1);q.a.addClass(q.c.c2);q.a.html(q.c.c3);q.bg.addClass(q.c.c4);fe(q.c.b);$(w).append(q.a);$(w).append(q.b);q.b.append(q.bg);q.d.map(function(i){i.q.addClass(i.n);i.q.html(i.t);$(i.q).on('click',function(){g.def=i.s;fc();fs();fp();});q.b.append(i.q);});if(q.c.a1){var p={q:$('<div class="pano-arrows">'),a:{l:$('<div class="pano-arrow pano-arrow-left">'),r:$('<div class="pano-arrow pano-arrow-right">'),u:$('<div class="pano-arrow pano-arrow-top">'),d:$('<div class="pano-arrow pano-arrow-bottom">')},b:{p:$('<div class="pano-zoom pano-zoom-plus">'),m:$('<div class="pano-zoom pano-zoom-minus">')}};for(let k in p.a){$(p.a[k]).on('click',function(){mm(k);});p.q.append(p.a[k]);};q.b.append(p.q);if((q.c.a2)&&(!q.c.a3))for(let k in p.b){$(p.b[k]).on('click',function(){nn(k);});q.b.append(p.b[k]);};}}function nn(j){var p={x:q.p.px,y:q.p.py};if(j=='p')dg=1;if(j=='m')dg=-1;fl(dg,p);}function mm(j){var p={x:q.p.px,y:q.p.py};if(j=='l')p.x+=q.c.a4;if(j=='r')p.x-=q.c.a4;if(j=='u')p.y+=q.c.a4;if(j=='d')p.y-=q.c.a4;m=true;um(p);m=false;}function fl(dg){q.p.z=(!q.c.a3)?q.p.z+dg*q.c.s:q.p.z;ff('xyz');q.z.w=q.c.w*q.p.z;q.z.h=q.c.h*q.p.z;fp();}function um(c){q.p.dx=c.x-q.p.px;q.p.dy=c.y-q.p.py;if(m){q.p.x+=q.p.dx;q.p.y+=q.p.dy;}q.p.px=c.x;q.p.py=c.y;ff('xy');fp();}function fp(){q.bg.css('background-image','url('+q.c.g+')');q.bg.css('background-repeat','repeat');q.bg.css('background-position',(q.p.x)+'px '+(q.p.y)+'px');q.bg.css('background-size',q.z.w+'px '+q.z.h+'px');q.d.map(function(i){i.x=(i.d)?(i.cx*q.p.z)+q.p.x-i.ax:i.cx-i.ax;i.y=(i.d)?(i.cy*q.p.z)+q.p.y-i.ay:i.cy-i.ay;i.x=a(i.x);i.q.css('left',i.x+'px');i.q.css('top',i.y+'px');});}function fe(sh){var ch=(j(sh))?'':sh;$(w).html(ch);q.b.html('');}function a(x){var b={w:$(w).width(),q:q.z.w-1};if(!q.c.a6){if(x<=b.w)x=b.w;if(x>=b.q)x=b.q;}x=x%q.z.w;while(x<=0)x+=q.z.w;return x;}function j(a){if(a==undefined)return true;if(a==null)return true;if(a==false)return true;if(a=='none')return true;if(a=='')return true;if(a=='0')return true;if(a==0)return true;if((a instanceof Array)&&(a.length==0))return true;return false;}}